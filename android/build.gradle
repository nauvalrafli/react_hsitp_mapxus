buildscript {
  ext {
    buildToolsVersion = "36.0.0"
    minSdkVersion = 26
    compileSdkVersion = 35
    targetSdkVersion = 35
    ndkVersion = "27.1.12297006"
    kotlinVersion = "2.0.20" // or 2.1.0 when stable
    reactNativeVersion = "0.81.1"
  }
  repositories {
    google()
    mavenCentral()
    gradlePluginPortal()
    maven {
      url("$rootDir/../node_modules/react-native/android")
    }
  }
  dependencies {
    classpath("com.android.tools.build:gradle:8.5.2")
    classpath("com.facebook.react:react-native-gradle-plugin:$reactNativeVersion")
    classpath("org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlinVersion")
    classpath("org.jetbrains.kotlin:compose-compiler-gradle-plugin:$kotlinVersion")
  }
}

apply plugin: "com.android.library"
apply plugin: "org.jetbrains.kotlin.android"
apply plugin: "org.jetbrains.kotlin.plugin.compose"
apply plugin: "com.facebook.react"
apply plugin: "kotlin-parcelize"

import groovy.json.JsonSlurper

// Load version from package.json
def packageJson = new JsonSlurper().parse(
    new File(rootDir, "../package.json")
)

def getExtOrIntegerDefault(name) {
  return rootProject.ext.has(name) ? rootProject.ext.get(name) : (project.properties["MapxusHsitp_" + name]).toInteger()
}

android {
  namespace "com.mapxushsitp"

  compileSdkVersion 35
  compileSdk 35

  defaultConfig {
    minSdkVersion 26
    targetSdkVersion 34

    buildConfigField "String", "VERSION_NAME", "\"${packageJson.version}\""
  }

  buildFeatures {
    buildConfig = true
    compose true
    viewBinding true
  }

  buildTypes {
    release {
      minifyEnabled false
    }
  }

  composeOptions {
    kotlinCompilerExtensionVersion = "1.5.10"
  }

  lintOptions {
    disable "GradleCompatible"
  }

  compileOptions {
    sourceCompatibility JavaVersion.VERSION_17
    targetCompatibility JavaVersion.VERSION_17
  }

  kotlinOptions {
    jvmTarget = "17"
  }

  sourceSets {
    main {
      java.srcDirs += [
        "generated/java",
        "generated/jni"
      ]
    }
  }
}

repositories {
  mavenCentral()
  google()
  maven {
    name 'release'
    url(MAPXUS_RELEASE_URL)
    allowInsecureProtocol = true
    credentials {
      username = MAPXUS_RELEASE_USERNAME
      password = MAPXUS_RELEASE_PASSWORD
    }
  }
  maven {
    url("$rootDir/../node_modules/react-native/android")
  }
  maven {
    url("$rootDir/../node_modules/jsc-android/dist")
  }
}

def kotlin_version = "2.0.20"

dependencies {
  implementation "com.facebook.react:react-android:$reactNativeVersion"
  implementation "org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version"

  implementation(platform("androidx.compose:compose-bom:2024.10.00"))
  // and ui library
  implementation("androidx.compose.material3:material3")
  //View Model
  implementation("androidx.lifecycle:lifecycle-viewmodel-compose:2.8.0")
  // OPTIONAL - Android Studio Preview support
  implementation("androidx.compose.ui:ui-tooling-preview")
  implementation("androidx.navigation:navigation-fragment-ktx:2.9.5")
  implementation("androidx.navigation:navigation-ui-ktx:2.9.5")
  implementation("androidx.navigation:navigation-dynamic-features-fragment:2.9.5")
  implementation 'androidx.appcompat:appcompat:1.6.1'
  implementation 'com.google.android.material:material:1.12.0'
  implementation 'androidx.activity:activity:1.9.2'
  implementation 'androidx.navigation:navigation-fragment-ktx:2.9.6'
  implementation 'androidx.navigation:navigation-ui-ktx:2.9.6'
  debugImplementation("androidx.compose.ui:ui-tooling")

  // Mapxus Android SDK - using placeholder for now
  implementation "com.mapxus.map:mapxusmap:11.2.1"
  implementation "com.mapxus.positioning:positioning:3.1.1"

  // Google Maps Utils for SphericalUtil
  implementation("com.google.maps.android:android-maps-utils:3.8.2")

  // Permission State
  implementation("com.google.accompanist:accompanist-permissions:0.37.3")

  implementation("io.github.sceneview:arsceneview:2.3.0")
  implementation("androidx.fragment:fragment-ktx:1.8.8")

  // rememberSystemUIController
  implementation("com.google.accompanist:accompanist-systemuicontroller:0.34.0")

  // Constraint Layout
  implementation("androidx.constraintlayout:constraintlayout-compose:1.1.1")

  // Fragment View Model on Activity and Fragment
  implementation("androidx.fragment:fragment-ktx:1.4.0")

  // GIF Image
  implementation("com.google.accompanist:accompanist-drawablepainter:0.35.0-alpha")

  implementation("com.github.bumptech.glide:glide:4.16.0")
  annotationProcessor("com.github.bumptech.glide:compiler:4.16.0")

  //tooltip
  implementation("com.github.skydoves:balloon:1.6.4")

  // Google Material Icons
  implementation("androidx.compose.material:material-icons-extended")
  implementation("androidx.compose.material:material")
  implementation("androidx.compose.material3:material3")

  implementation("androidx.navigation:navigation-compose:2.9.0")
  implementation 'androidx.compose.ui:ui:1.9.1'
}
